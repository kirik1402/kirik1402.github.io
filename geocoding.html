<!DOCTYPE html>
<html>
<head>
    <title>Геокодирование с Nominatim и Leaflet</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script>
        function initMap() {
            var map = L.map('map').setView([55.76, 37.64], 10); // Москва

            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);

            window.map = map;
        }

        function geocodeAddress() {
            var address = document.getElementById('address').value;
            var url = `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(address)}`;

            fetch(url)
                .then(response => response.json())
                .then(data => {
                    if (data.length > 0) {
                        var result = data[0];
                        var lat = result.lat;
                        var lon = result.lon;

                        map.setView([lat, lon], 16);

                        var marker = L.marker([lat, lon]).addTo(map);
                        marker.bindPopup(result.display_name).openPopup();
                    } else {
                        alert('Адрес не найден');
                    }
                })
                .catch(error => {
                    alert('Ошибка геокодирования: ' + error);
                });
        }

        window.addEventListener('load', initMap);
    </script>
</head>
<body>
    <input id="address" type="text" placeholder="Введите адрес">
    <button onclick="geocodeAddress()">Геокодировать</button>
    <div id="map" style="height: 500px; width: 100%;"></div>
</body>
</html>